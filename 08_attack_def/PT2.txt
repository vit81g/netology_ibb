Методология :
OSSTMM 3
PTES
SP 800-115  (NIST)
PTF
 
4 этапа:
разведка, сбор информации (рекогносцировка)
сканирование
эксплуатация
постэксплуатация

1. Рекогносцировка
зоны ip адресов, dns, subdomains (OSINT Framework)

theHarvester
theHarvester -d netology.ru -l 500 -n -b google
Выдаст первые 500 упоминаний о нетологии в гугл

Гугл дорки:
site:github.com netology
Поиск нетологи (в мягком совпадении, где упомянуто) в гитхабе
site:github.com "netology.ru"
совпадение по сайту

Методанные с файлов организации
site:netology.ru filetype:pdf
сбор файлов с сайта по типу pdf

strings - вытащит метаданные из файла
экзифтулс

google hacking database (база данных запросов)
shodan.io
активное сканирование здесь запрещено на этом этапе

2. Сканирование
поиск активных систем
Трасеровка (где какие хосты, сколько хопов)
сканирование портов
определение ОС
какой софт и какой версии
поиск уязвимостей на основе ОС и ПО

1)Уменьшение диапозона IP адресов для сканирования (но если вам сказали что сервисы крутятся в этом диапозоне)

2)Сканирование топ портов или пула портов (но если вам сказали что сервисы крутятся в этом диапозоне)

3)сканируем порты которые пропускает фаревол

4)большое количество сканеров параллельно работает (DDoS  может произойти)

5)снижение таймаута при сканировании (можно потерять пакеты, если проблемы в сети или далеко расположена)
сканируем ближе к объекту, на сети провайдера, поднять в облаке сканер, если объект в облаке

6)Zmap и другие инструменты для сканирования

Лучше сканировать организацию изнутри, настроить vpn для соединения с сетью организации (с wireshark, для понимания пакетов, vpn может отбрасывать определенные пакеты)

udp 443 - quick прокол внутри TCP + HTTP v2, все это шифруется tls и пускаем через UDP (UDP - отправляй и молись, что бы дошло, а TCP работает по правилам и никто не будет его править) - для ИБ данные протокола нет инструментов для обработки. Плюсы - можны скрыть свой трафик.

3. Эксплуатация
Сервисные Exploit
Exloit - нацелины на сервисы
для windows
MS08-067 использует службу SMB
MS17-010 использует службу SMB

CVE-2022-1388 получаем контроль над устройством F5 (BIG-IP) получаем рут, даже с доступом к панели управления

Клиентские Exploit
Нацелены на софт 
Zero CLick Exploit

собрать как можно больше данных по софту, сервисам, что где работает

Exploit LPE
LPE Повышение локальных привелегий
Эксплоит Dirty Cow


Search Exploit
Поиск эксплоитов
Github.com - Table of PoCs
TrendMicro - блог об уязвимостях
Exploit DataBase - агрегатор эксплоитов  

Надо быть аккуратным при использовании эксплоитов. Что бы не навредить заказчику.

В Kali searchsploit <параметр>
searchsploit ms17-010

metasploit 
metasploit unleashed - гайд по бесплатному metasploit

cobalt strike
Canvas

Полезная нагрузка - установить соединение и докинуть нагрузку

Shell - получение доступа к системе
Прямые и обратные
Прямой - доступ к компьютеру жертвы, посылаем эксплоит shell и получаем доступ
Плохо когда есть система контроля (МЭ, NAT, IDS, IPS) вы прошли на порт 443 и открыли порт 3337 и ваше соединение блокируется МЭ

Обратный - инициирует соединение от себя до вас
Вы получаете доступ минуя МЭ, nat (igress - трафик уходит за пределы организации), вас не видно. Но IDS IPS могут заметить



4. Постэксплуатация
4.1 Сбор информации изнутри
Хэши, ключи, исходный код ищем, файлы пользователей на предмет паролей, процессы в системе, соединения, софт, какие СЗИ
 
4.2 Закрепление
Измениние конфигураций, обустраиваем плацдарм, заносим сканеры, программы свои, настраиваем роутинг. Основная цель добраться до нужной информации описаной в скоупе

Meterpreter - программа от metasploit инструмент для закрепления
+ шифрование через tls между вами и целью (плацдармам)
+ не заметит СЗИ (шифрование трафика)
+ модули и расширения (python например, извлечения паролей, nmap)
Снифирить
Кейлогеры
снимки экрана
снимки камеры
passhash - для винды, можно получить хэш и авторизироваться

4.3 Чистка следов
удаляем все артифакты о наших действиях
чистка логов
удаление эксплоитов
разрываем соединения

5. Написание отчета
разбить на части: 
для руководства, для системных администраторов, для менеджмента, для различных аудиторий

5.1 Резюме для руководства (самая важная часть отчета)
пишем чистым понятным языком, без технических обозначений

5.2 Вступление
Перечисляем уязвимости, критичность, краткое резюме об уязвимостях











 



























































































